---
- name: "Copy files to the host"
  copy: 
    src: /root/project/artifact.tar.gz
    dest: /home/ubuntu
- name: "mkdir for the extracted file"
  file:
    path: /home/ubuntu/backend
    state: directory
- name: "Untar the source"
  command: tar -xvf /home/ubuntu/artifact.tar.gz -C /home/ubuntu/backend
- name: "Go to the right directory"
  command: chdir=/home/ubuntu/backend ls
- name: "Install npm"
  command: npm install
- name: "Stop the default pm2"
  command: pm2 stop all
- name: "Start npm pm2"
  command: pm2 start npm -- start

